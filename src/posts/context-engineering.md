---
title: 上下文工程的经济分析
date: "2025-12-26"
tags: ["人工智能", "上下文工程"]
draft: false
---

如果我们把 AI Agent 的运行看作是一个微型的经济系统，那么**上下文窗口（Context Window）**就是这里面最稀缺的生产资源——它就像是工厂里寸土寸金的车间，或者办公桌上有限的台面。

如何在这个有限的空间里产出最大的价值？这其实是一个经典的经济学问题。基于罗纳德·科斯（Ronald Coase）的**交易成本理论**，我们可以把上下文工程的核心挑战看作是：如何明智地选择“Skills（工具技能）”和“Sub-agents（子智能体）”，以最小化交易成本。

对于 AI 来说，每一行被塞进上下文的 Skill 说明，每一个与之交互的 Sub-agent 指令，都是成本。这不仅是真金白银的 Token 计费，更是一种隐形的**机会成本**。你的上下文空间被无关紧要的工具说明占满了，真正核心的任务数据和复杂的推理过程就没地方放了。这就好比你的办公桌上堆满了不仅常用甚至根本用不到的工具，导致你连摊开图纸画图的地方都没有。更糟糕的是，过多的噪音还会分散模型的注意力，导致它更容易产生“幻觉”或者忘记原本的指令。

那么，究竟该选 Skills 还是 Sub-agents？这有点像企业在决定是“内部生产”还是“外包购买”。

**Skills 就像是贴身携带的工具包，或者是内部员工。** 

它们的特点是随叫随到，反应快，沟通成本极低。你不需要跟它解释大背景，直接调用就行。但是，它们的“维护成本”很高——只要你挂在身上，它们就一直占据着你的负重（上下文空间）。如果你背了100个工具却只用了其中1个，那就是巨大的浪费。所以，Skills 最适合那些**高频、简单、明确**的任务，比如查天气、做加减法。

**Sub-agents 则像是专业的外部承包商。**

当你遇到一个极度复杂或者极度专业的任务时，比如写一份长篇研报，你自己做太费劲，全挤在自己的上下文里也处理不过来。这时候，找一个专门负责搜集数据的 Sub-agent，再找一个专门负责绘图的 Sub-agent，就是更好的选择。

这种“外包”最大的好处是**信息封装**。承包商（Sub-agent）只负责把最终结果交给你，中间那些乱七八糟的搜索记录、草稿、错误尝试，统统留在他们自己的上下文里，不会污染你的办公桌。这就是用“空间换深度”。当然，外包也是有成本的，你需要花时间去写清楚需求（Prompt），还需要冒着对方可能会误解风险。所以，只有当任务足够复杂，或者需要极高的专业背景（资产专用性）时，外包才是划算的。

理解了这一点，我们就能探索出一些更聪明的**上下文管理策略**：

首先是不搞“大锅饭”，推行**按需加载（Just-in-Time）**。不要一股脑把所有能用的 Skills 都塞进 prompt，而是像语义检索（RAG）那样，当前任务需要什么，临时把那几个相关的 Skills 加载进来。这就像是工厂里不囤积零件，需要生产什么才把对应的零件送到流水线上，大大节省了库存成本。

其次是建立**层级管理（Hierarchy）**。面对庞大的任务，不要让主 Agent 陷入细节的泥潭。主 Agent 应该像 CEO 一样，只负责制定战略目标，把具体的执行细节分包给 Sub-agents。主 Agent 的上下文里只保留“数据摘要”和“最终结论”，而不是数万字的原始材料。

最后是保持**动态灵活性**。世界是变化的，预设的工具总有不够用的时候。最理想的架构是允许 Agent 在发现现有 Skills 搞不定时，能够动态地生成和调用一个新的 Sub-agent。这种面对不确定性时的自适应能力，才是高级 Agent 的体现。

归根结底，上下文工程不是单纯的技术堆叠，而是一场精妙的**成本平衡游戏**。你是在用 Skills 的便捷去换取空间的占用，还是用 Sub-agents 的封装去换取沟通的消耗？在这两者之间找到最佳的平衡点，就是上下文工程的艺术所在。